<!doctype html>
<html>
<head>
  <title>Turtles</title>
</head>
<style>
.background {
  background: url('parallax/backdrop.jpg, url('parallax/backdrop.png');
  background-size: auto 100%;
  background-repeat: no-repeat;
  width: 100%;
  height: 4000px;
  position: fixed;
  left: 0;
  top: 0;
  overflow: hidden;
} 
.block {
  position: fixed;
  color: white;
  width: 50%;
  box-sizing: border-box;
  -webkit-box-sizing: border-box;
  padding-left: 15%;
  font-size: x-large;
  left: 0;
}
</style>
<body>
<div class="background"></div>  

<div class="you-found-me block">
  You've found my secret page-a-day blog! Or maybe I've published it.  Who knows.  What this is is every weekday, I build a webpage.  Something I want to do that I can do in just one HTML file.  You heard me right - one, gruesomely long HTML file with a style tag and script tag included - no dependencies (that means no jQuery either).  The horrors.  But it challenges me a lot to keep my ideas simple - not necessarily easy, but simple.
</div>

<div class="what-is-parallax block">
  This is day 2.75 of 3 of parallax.  What is parallax? Think Super Mario Bros - how the mountains in the back move slower than the main content.  It gives the game a false sense of depth.  That's parallax.
</div>

<div class="about-project block">
  Today was all about making the Page silky smooth and beautiful.  I got the first part down - AND it works on mobile, but I'm going to spend an hour or two Saturday making it a bit more presentable
</div>

<div class="any-ipsum block">
  To show off the sweet background I made though, I'm going to throw in some ipsum text!  It's gonna be turtle ipsum, generated by <a href="http://anyipsum.com">anyipsum.com</a>!
</div>

<div class="sea-turtle-ispum block">
  Worlds had worlds turtles species. Worlds endangered turtles worlds except marine. Turtles was superfamily species. Turtles was turtle turtles species. Worlds was superfamily turtles. Inhabit was turtles species worlds inhabit. Marine were turtle worlds most inhabit. Most was marine worlds species. Turtle endangered marine turtle turtles.
</div>

<div class="sea-turtle-ispum block">
  Marine endangered turtles oceans chelonioidea turtles. Superfamily were turtles turtles turtles. Turtle was turtle inhabit. Inhabit were most species chelonioidea. Arctic had superfamily species. Turtles endangered chelonioidea arctic turtles chelonioidea. Arctic endangered except except turtles most. Turtles had turtles inhabit marine superfamily. Turtles had marine superfamily except.
</div>

<div class="sea-turtle-ispum block">
Arctic had superfamily most. Arctic had turtles superfamily turtle turtle. Superfamily was turtles turtles. Turtles endangered species turtle turtles. Turtles were turtle species. Species endangered turtles turtle except inhabit. Marine were species chelonioidea arctic. Superfamily had turtles turtles. Turtles were inhabit marine worlds.
</div>

<div class="sea-turtle-ispum block">
Worlds endangered arctic superfamily. Arctic endangered oceans chelonioidea most turtles. Most had turtle turtles most most. Turtles endangered arctic turtles inhabit turtle. Turtles was most inhabit. Inhabit was oceans marine most turtles. Worlds were turtles marine most. Turtles endangered turtles turtle. Superfamily was marine marine.
</div>

<div class="sea-turtle-ispum block">
Chelonioidea endangered turtles marine worlds. Species were turtles inhabit inhabit except. Most endangered chelonioidea oceans marine oceans. Oceans endangered turtles arctic. Arctic had oceans inhabit. Turtles had turtles turtles. Superfamily endangered superfamily arctic worlds. Turtle endangered superfamily worlds turtles except. Turtles had inhabit worlds.
</div>

<script>
  var Page = {
    height: window.innerHeight, 
    width: window.innerWidth,
    pagelets: [],
    offset: 0,
    $background: document.getElementsByClassName('background')[0],
    initialize: function() {
      Page.findPagelets()
      Page.position()
      Page.eachPagelet('position')
    },
    findPagelets: function() {
      var elements = document.getElementsByClassName('block')
      for (var i=0; i < elements.length; i++) new Pagelet(elements[i], i)
    },
    position: function() {
      document.body.style.height = Page.height*Page.pagelets.length+'px'
    },
    scroll: function(distance, speed) {
      Page.offset = Math.round(distance * speed) 
      Page.$background.style.webkitTransform='translateY('+Page.offset+'px)'
    },
    nudge: function(distance) {
      Page.offset = Page.offset + distance
      Page.$background.style.webkitTransform="translateY("+Page.offset+"px)"
    },
    findClass: function(name) {
      return document.getElementsByClassName(name)[0]
    },
    eachPagelet: function(method, args) {
      for (var i=0; i < Page.pagelets.length; i++) Page.pagelets[i][method](args)
    },
    extraOffset: function() {
      Page.maxOffset = -(Page.height*(Page.pagelets.length-1))/5
      if ( Page.offset > 0 ) return -Page.offset
      if ( Page.offset < Page.maxOffset) return Page.maxOffset - Page.offset
      return 0
    }
  }

  function Pagelet(html, index) {
    this.$html=html
    this.index=index
    this.name =html.classList[0]
    this.offset=0
    Page.pagelets.push(this)
  }
  Pagelet.prototype.position = function() {
    this.$html.style.height = Page.height+'px'
    this.$html.style.top = Page.height * this.index +'px'
    this.$html.style.paddingTop = Math.round(Page.height*0.35)+'px'
  } 
  Pagelet.prototype.scroll = function(distance) {
    this.$html.style.webkitTransform="translateY("+distance+"px)"
  }
  Pagelet.prototype.nudge = function(distance) {
    this.offset = this.offset + distance
    this.$html.style.webkitTransform="translateY("+this.offset+"px)"
  }

  // MOBILE IMPLEMENTATION

  var Touch = {
    start: function(e) {
      e.preventDefault()
      Touch.lastY=e.touches[0].screenY
    },
    move: function(e) {
      var eventY = e.touches[0].screenY
      Touch.nudge(eventY - Touch.lastY)
      Touch.lastY = eventY
    },
    end: function(e) {
      Touch.nudge(Page.extraOffset())
      Touch.lasY = null
    },
    nudge: function(distance) {
      Page.nudge(distance)
      Page.eachPagelet('nudge', distance*5)
    }
  }

  document.body.addEventListener('touchstart', Touch.start)
  document.body.addEventListener('touchmove', Touch.move)
  document.body.addEventListener('touchend', Touch.end)

  Page.initialize()
  window.onscroll = function() {
    var distance = document.all? iebody.scrollTop : pageYOffset
    Page.scroll(-distance, 0.2)
    Page.eachPagelet('scroll', -distance)
  }

</script>
</body>
</html>
